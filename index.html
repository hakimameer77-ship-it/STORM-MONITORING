<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StormWatch | Lightning Monitoring System</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* --- CSS STYLES --- */
        :root {
            --primary: #ff9f1c; 
            --dark-bg: #0b132b;
            --glass-white: rgba(255, 255, 255, 0.08);
            --border: rgba(255, 255, 255, 0.1);
        }

        html { scroll-behavior: smooth; }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: var(--dark-bg); color: #fff; line-height: 1.6; }

        /* Lightning Effect */
        .lightning-bg { position: fixed; inset: 0; z-index: -2; background: radial-gradient(circle at center, #1c2541 0%, #0b132b 100%); }
        .flash-overlay { position: fixed; inset: 0; background: #fff; opacity: 0; z-index: -1; pointer-events: none; }
        .strike-anim { animation: lightning-flash 0.4s ease-out; }
        @keyframes lightning-flash { 0%, 100% { opacity: 0; } 10% { opacity: 0.6; } 25% { opacity: 0.8; } }

        /* Navigation Bar */
        .navbar { 
            background: rgba(0, 0, 0, 0.9); 
            backdrop-filter: blur(12px); 
            position: fixed; 
            top: 0; 
            width: 100%; 
            z-index: 1000; 
            border-bottom: 1px solid var(--border); 
        }
        .nav-container { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; padding: 15px 25px; }
        .logo { font-weight: 800; color: var(--primary); font-size: 1.3rem; display: flex; align-items: center; gap: 10px; }
        .nav-links { display: flex; list-style: none; gap: 25px; }
        .nav-links a { text-decoration: none; color: #bbb; font-weight: 600; font-size: 0.9rem; transition: 0.3s; }
        .nav-links a:hover { color: var(--primary); }

        /* Sections */
        section { padding: 100px 20px; max-width: 1100px; margin: 0 auto; min-height: 100vh; }
        .section-title { font-size: 2.5rem; margin-bottom: 40px; text-align: center; color: var(--primary); }

        /* Cards & Glassmorphism */
        .glass-card { background: var(--glass-white); backdrop-filter: blur(10px); padding: 40px; border-radius: 25px; border: 1px solid var(--border); }
        .hero-box { 
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1605721911519-3dfeb3be25e7?auto=format&fit=crop&w=1200&q=80') center/cover;
            padding: 100px 40px; border-radius: 30px; text-align: center; border: 1px solid var(--border); width: 100%;
        }

        /* Flow nodes */
        .flow-node { display: flex; align-items: flex-start; gap: 20px; margin-bottom: 25px; }
        .node-num { background: var(--primary); color: #000; font-weight: 800; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }

        /* Grid Layouts */
        .feature-grid, .demo-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .feature-card, .stat-card { background: var(--glass-white); padding: 30px; border-radius: 20px; border: 1px solid var(--border); text-align: center; }
        .feature-card i { font-size: 2.5rem; color: var(--primary); margin-bottom: 15px; }

        /* Project Chart Area */
        .chart-box { background: var(--glass-white); padding: 25px; border-radius: 20px; margin-top: 30px; border: 1px solid var(--border); }
        .chart-container { height: 400px; width: 100%; }
        .refresh-btn { background: var(--primary); border: none; padding: 12px 24px; border-radius: 8px; color: #fff; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .refresh-btn:hover { transform: scale(1.05); background: #ffa500; }

        /* Status & Footer */
        .dot { height: 12px; width: 12px; border-radius: 50%; display: inline-block; background: #ff4757; margin-right: 8px; }
        .pulse { animation: pulse-status 1.5s infinite; }
        @keyframes pulse-status { 0% { box-shadow: 0 0 0 0 rgba(255, 159, 28, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(255, 159, 28, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 159, 28, 0); } }
        .main-footer { text-align: center; padding: 50px; background: rgba(0,0,0,0.3); border-top: 1px solid var(--border); }
        #myt-clock { color: var(--primary); font-size: 1.2rem; font-weight: 800; }

        @media (max-width: 768px) {
            .nav-links { display: none; }
            .section-title { font-size: 1.8rem; }
        }
    </style>
</head>
<body>

    <div class="lightning-bg"></div>
    <div class="flash-overlay" id="flash-effect"></div>

    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-bolt-lightning"></i> <span>STORM-WATCH</span>
            </div>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#flow">Flow</a></li>
                <li><a href="#features">Features</a></li>
                <li><a href="#project">Interactive Project</a></li>
                <li><a href="#mission">Mission</a></li>
            </ul>
        </div>
    </nav>

    <section id="home">
        <div class="hero-box">
            <h1 style="font-size: 3.5rem;">STORM-WATCH</h1>
            <p>Advanced IoT-Based Lightning Monitoring System</p>
            <div style="margin-top: 20px;">
                <span id="status-dot" class="dot pulse"></span> <span id="esp-status">CONNECTING TO DEVICE...</span>
            </div>
        </div>
    </section>

    <section id="flow">
        <h2 class="section-title">Project Flow</h2>
        
        <div class="glass-card">
            <div class="flow-node">
                <div class="node-num">1</div>
                <div><p><strong>AS3935 Sensor:</strong> Detects electromagnetic radiation from lightning strikes up to 40km away.</p></div>
            </div>
            <div class="flow-node">
                <div class="node-num">2</div>
                <div><p><strong>ESP32 Microcontroller:</strong> Processes the raw sensor data and calculates storm proximity.</p></div>
            </div>
            <div class="flow-node">
                <div class="node-num">3</div>
                <div><p><strong>Blynk IoT Cloud:</strong> Synchronizes live data wirelessly across the network.</p></div>
            </div>
            <div class="flow-node">
                <div class="node-num">4</div>
                <div><p><strong>Dashboard Visualization:</strong> Real-time alerts and graphical tracking for users.</p></div>
            </div>
        </div>
    </section>

    <section id="features">
        <h2 class="section-title">Key Features</h2>
        <div class="feature-grid">
            <div class="feature-card"><i class="fas fa-microchip"></i><h3>Franklin Sensor</h3><p>Industry-grade lightning detection technology.</p></div>
            <div class="feature-card"><i class="fas fa-wifi"></i><h3>Cloud Sync</h3><p>Real-time updates via Blynk IoT Platform.</p></div>
            <div class="feature-card"><i class="fas fa-bell"></i><h3>Safety Alerts</h3><p>Instant danger warnings for campus residents.</p></div>
        </div>
    </section>

    <section id="project">
        <h2 class="section-title">Interactive Project</h2>
        <div class="demo-grid">
            <div class="stat-card">
                <p>Live Proximity</p>
                <h2 id="storm-distance" style="font-size: 3.5rem; color: var(--primary);">-- KM</h2>
                <p>Last Signal: <span id="last-update">Scanning...</span></p>
            </div>
            <div class="stat-card">
                <p>Hardware Status</p>
                <h3 style="margin-top: 10px;">ESP32 Node-01</h3>
                <p>Developer: Ameer Hakim</p>
                <p>ID: CN230083</p>
            </div>
        </div>
        
        <div class="chart-box">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3>Strike Distance History</h3>
                <button class="refresh-btn" onclick="fetchBlynkData()">Refresh Data</button>
            </div>
            <div class="chart-container">
                <canvas id="lightningChart"></canvas>
            </div>
        </div>
    </section>

    <section id="mission">
        <h2 class="section-title">Our Mission</h2>
        <div class="glass-card" style="text-align: center; padding: 60px 20px;">
            <i class="fas fa-quote-left" style="font-size: 2.5rem; color: var(--primary); margin-bottom: 15px;"></i>
            <p style="font-size: 1.4rem; font-style: italic;">
                "Our mission is to safeguard the UTHM community by providing accurate, real-time lightning alerts 
                through innovative IoT technology, ensuring proactive disaster prevention and safety awareness."
            </p>
        </div>
    </section>

    <footer class="main-footer">
        <div id="myt-clock">00:00:00 AM</div>
        <p>Malaysia Standard Time (MYT)</p>
        <p style="margin-top: 15px; opacity: 0.6;">&copy; 2026 StormWatch | UTHM Engineering Project</p>
    </footer>

    <script>
        /* --- JAVASCRIPT --- */
        const BLYNK_TOKEN = "pd3Q6apyv8yfY9lmqOu_9IF8Gy3ldLpd";
        const URL_DIST = `https://blynk.cloud/external/api/get?token=${BLYNK_TOKEN}&V1`;

        // Lightning Animation
        const flashLayer = document.getElementById('flash-effect');
        function triggerLightning() {
            flashLayer.classList.add('strike-anim');
            setTimeout(() => flashLayer.classList.remove('strike-anim'), 400);
            setTimeout(triggerLightning, Math.random() * 10000 + 5000);
        }
        triggerLightning();

        // MYT Clock
        setInterval(() => {
            document.getElementById('myt-clock').innerText = new Date().toLocaleTimeString('en-US', { hour12: true });
        }, 1000);

        // Chart.js Setup
        const ctx = document.getElementById('lightningChart').getContext('2d');
        const liveChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Storm Distance (KM)',
                    data: [],
                    borderColor: '#ff9f1c',
                    backgroundColor: 'rgba(255,159,28,0.1)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true, max: 40, grid: { color: 'rgba(255,255,255,0.05)' } },
                    x: { grid: { display: false } }
                }
            }
        });

        // Blynk API Logic
        async function fetchBlynkData() {
            try {
                const response = await fetch(URL_DIST);
                const val = await response.text();
                const dist = parseInt(val);

                if (!isNaN(dist)) {
                    document.getElementById('storm-distance').innerText = dist + " KM";
                    document.getElementById('esp-status').innerText = "DEVICE ONLINE";
                    document.getElementById('esp-status').style.color = "#00ff88";
                    document.getElementById('status-dot').style.background = "#00ff88";
                    
                    const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    document.getElementById('last-update').innerText = time;

                    if (liveChart.data.labels.length > 15) {
                        liveChart.data.labels.shift();
                        liveChart.data.datasets[0].data.shift();
                    }
                    liveChart.data.labels.push(time);
                    liveChart.data.datasets[0].data.push(dist);
                    liveChart.update();
                }
            } catch (e) {
                document.getElementById('esp-status').innerText = "DEVICE OFFLINE";
                document.getElementById('esp-status').style.color = "#ff4757";
                document.getElementById('status-dot').style.background = "#ff4757";
            }
        }

        setInterval(fetchBlynkData, 5000);
        fetchBlynkData();
    </script>
</body>
</html>
